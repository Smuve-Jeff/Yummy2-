<!-- Backdrop -->
<div class="fixed inset-0 bg-black/60 z-40 animate-fade-in" (click)="onClose()"></div>

<!-- Panel -->
<div class="fixed inset-x-4 bottom-4 sm:inset-auto sm:left-1/2 sm:top-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 border-2 bg-black/90 backdrop-blur-lg p-4 w-auto max-w-md z-50 animate-slide-up font-mono"
  [class]="'border-' + theme().primary + '-400/50'"
  [class]="'text-' + theme().primary + '-400'">

  <div class="flex justify-between items-center mb-4">
    <h2 class="text-lg">[[ Equalizer & Enhancements ]]</h2>
    <button (click)="onClose()" class="border px-2 hover:text-black transition-colors"
      [class]="'border-' + theme().primary + '-400/50'"
      [class]="'hover:bg-' + theme().primary + '-400'">
      [X]
    </button>
  </div>

  <div class="mb-4">
    <h3 class="text-sm mb-2">// Graphic EQ</h3>
    <div class="flex justify-around items-end h-48 bg-black/50 p-4"
      [class]="'border border-' + theme().primary + '-400/30'">
      @for (band of eqSettings(); track $index) {
        <div class="flex flex-col items-center">
          <input
            type="range"
            min="0"
            max="100"
            [value]="band.value"
            (input)="onEqBandChange($index, $event)"
            class="slider vertical-slider"
            [style.--thumb-bg]="'var(--color-' + theme().primary + '-400)'"
            [style.--track-bg]="'var(--color-' + theme().primary + '-950)'"
            [style.--thumb-border]="'var(--color-' + theme().primary + '-900)'"
          />
          <span class="text-xs text-green-400/60 mt-2">{{ band.label }}</span>
        </div>
      }
    </div>
  </div>

  <div>
    <h3 class="text-sm mb-2">// Enhancements</h3>
    <div class="space-y-2">
      <label class="flex items-center justify-between p-2 bg-black/50 cursor-pointer"
        [class]="'border border-' + theme().primary + '-400/30'">
        <span>Bass Boost</span>
        <div class="relative inline-flex items-center cursor-pointer">
          <input type="checkbox" [checked]="enhancements().bassBoost" (change)="onEnhancementToggle('bassBoost', $event)" class="sr-only peer">
          <div class="w-9 h-5 border flex items-center justify-center text-xs peer-checked:text-black"
            [class]="'border-' + theme().primary + '-400/50'"
            [class]="'peer-checked:bg-' + theme().primary + '-400'">
            <span class="peer-checked:hidden">[&nbsp;&nbsp;]</span>
            <span class="hidden peer-checked:inline">[X]</span>
          </div>
        </div>
      </label>
      <label class="flex items-center justify-between p-2 bg-black/50 cursor-pointer"
        [class]="'border border-' + theme().primary + '-400/30'">
        <span>Surround Sound (UI Only)</span>
        <div class="relative inline-flex items-center cursor-pointer">
          <input type="checkbox" [checked]="enhancements().surroundSound" (change)="onEnhancementToggle('surroundSound', $event)" class="sr-only peer">
          <div class="w-9 h-5 border flex items-center justify-center text-xs peer-checked:text-black"
            [class]="'border-' + theme().primary + '-400/50'"
            [class]="'peer-checked:bg-' + theme().primary + '-400'">
            <span class="peer-checked:hidden">[&nbsp;&nbsp;]</span>
            <span class="hidden peer-checked:inline">[X]</span>
          </div>
        </div>
      </label>
    </div>
  </div>
</div>